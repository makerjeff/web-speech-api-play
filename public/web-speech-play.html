<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,300' rel='stylesheet' type='text/css'>
    <title>Spitch</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        body, html {
            position: relative;
            width: 100%;
            height: 100%;
        }

        #container {
            display: flex;
            position: relative;

            width: 100%;
            height: 100%;

            flex-direction: column;

            justify-content: center;
            align-items: center;
        }

        #title{
            font-family: Montserrat, sans-serif;
        }

        #debug_messages {
            font-family: "Open Sans", sans-serif;
        }

    </style>
</head>
<body>


<div id="container">
    <div id="title" class="normal">
        <h1>Say Something.</h1>
    </div>

    <div id="debug_messages"> </div>

</div>


<script>

    var keys  = [
        {name: 'monkey', string: 'I am a monkey.'},
        {name: 'starfish', string: 'I am a starfish'},
        {name: 'cat', string: 'I am a cat'}
    ];

    // speech grammar format
    var grammar = '#JSGF V1.0; grammar colors; public <color> = red | green | blue | black ;';

    // feed the right module into chrome
    var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
    var SpeechGrammarList = SpeechGrammarList || webkitSpeechGrammarList;
    var SpeechRecognitionEvent = SpeechRecognitionEvent || webkitSpeechRecognitionEvent;

    // create speech recognition instance
    var recognition = new SpeechRecognition();
    var speechRecognitionList = new SpeechGrammarList();

    // add grammar to grammars
    speechRecognitionList.addFromString(grammar, 1);
    recognition.grammars = speechRecognitionList;

    //set params
    //recognition.continuous = true;  //hide this if no continuous
    recognition.lang = 'en-US';
    recognition.interimResults = true;
    recognition.maxAlternatives = 1;

    var diagnostic = document.getElementById('debug_messages');
    var bg = document.getElementById('container');

    document.body.addEventListener('click', function(e){
        recognition.start();
        console.log('ready to listen!');
    });

    recognition.onresult = function(e) {
        var color = e.results[0][0].transcript;
        diagnostic.textContent = 'Result received: ' + color + '. ';
        bg.style.backgroundColor = color;
        console.log('Confidence level: ' + event.results[0][0].confidence);
    };

    recognition.onspeechend = function() {
        recognition.stop();
        console.log('Stopped listening.');
    };

    recognition.onnomatch = function(e){
        diagnostic.textContent = 'I didn\'t recognize that. ';
    };

    recognition.onerror = function(e) {
        diagnostic.textContent = 'Err0r! : ' + e.error;
    };


    /* ============= JEFF DEBUG CONTROLS ============= */
//    //Jeff-Made-Buttons
//    var buttonState = false;
//    var startButton = document.getElementById('start_button');
//    var title = document.getElementById('title');
//    var debug = document.getElementById('debug_messages');
//
//    //test
//    startButton.addEventListener('click', function(e){
//        buttonState = !buttonState;
//        console.log(buttonState);
//        startButton.innerText = buttonState;
//
//        if(buttonState == true) {
//            title.classList.remove('normal');
//            debug.innerHTML = 'listening!';
//
//            if(title.classList.contains('red')) {
//                title.classList.remove('red');
//                title.classList.add('green');
//                console.log('I see red! Deleting now.');
//            } else {
//                title.classList.add('green');
//            }
//        } else {
//            title.classList.remove('green');
//            title.classList.add('red');
//            debug.innerHTML = 'not listening.';
//        }
//    });
//



</script>
</body>
</html>